<!-- 地图容器 -->
<section>
  <div class="container">
    <div id="map" class="leaflet-map"></div>
  </div>
</section>

<!-- Leaflet 样式 -->
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/leaflet/1.9.4/leaflet.css"
/>

<!-- Leaflet 脚本 -->
<script src="https://cdn.staticfile.org/leaflet/1.9.4/leaflet.js"></script>

<!-- 地图初始化 -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const el = document.getElementById('map');
    if (!el) return;

    const latitude = {{ .latitude | default "35.101525" }};
    const longitude = {{ .longitude | default "118.348651" }};
    const address = `{{ .address | default "Xincheng Technology Tower" | safeHTML }}`;

    const map = L.map('map', {
      center: [latitude, longitude],
      zoom: 15,
      scrollWheelZoom: false,
    });

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors',
    }).addTo(map);

    L.marker([latitude, longitude]).addTo(map).bindPopup(address).openPopup();

    // 防止地图容器尺寸问题
    setTimeout(() => map.invalidateSize(), 200);
  });
</script>

<style>
  /* 可放入 custom.scss 中 */
  .leaflet-map {
    height: 400px;
    max-width: 100%;
    width: 100%;
    margin: 0 auto 20px auto;
  }
</style>
